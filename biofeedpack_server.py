import serialimport timeimport sysimport osimport randomfrom PIL import Image, ImageFilter, ImageGrab#import pyscreenshot as ImageGrab#External dependencies: pySerial, Pillow (,pyscreenshot (on linux))#Try to find an arduino and then create a connection.ser = Nonefor i in range(6):    try:        ser = serial.Serial('COM'+str(i), 9600)        break    except serial.SerialException:        print("[-] - Cannot find arduino at COM"+str(i))if not ser:    print("[-] - Please check the arduino is actually connected...")    print("[-] - Exiting...")    sys.exit(1)print("[+] - Arduino found!")print("[*] - Waiting for the connection to be established...")          time.sleep(5) print("[+] - Done!")PURPLE = (116, 29, 139)CYAN = (10, 130, 141)YELLOW = (165, 141, 9)DIST_TRESHOLD = 50POLLXY = (497,716)ACTIVATION_CHANCE = 1.0def euclidean_dist(tup1, tup2):    dist = 0    for i in range(3):        dist += abs(tup1[i] - tup2[i])    return distdef main():    '''    print(time.time())    #im = Image.open(os.getcwd()+"\\cybathlon.png")    for i in range(30):        im = ImageGrab.grab()    print(time.time())    print()    im.show()    '''    try:        while True:            im = ImageGrab.grab()            rgb = im.getpixel((15,15))[0:3]            print(rgb)            msg = None            if euclidean_dist(rgb, PURPLE) < DIST_TRESHOLD:                msg = "P#"            elif euclidean_dist(rgb, CYAN) < DIST_TRESHOLD:                msg = "C#"            elif euclidean_dist(rgb, YELLOW) < DIST_TRESHOLD:                msg = "Y#"            if msg:                print("[*] - Found " + msg)                if random.random() > ACTIVATION_CHANCE:                    print("[*] - Sending message: " + msg)                    ser.write(msg.encode())                    time.sleep(1)    except KeyboardInterrupt:        print("\n[*] - Received KeyboardInterrupt.")if __name__ == "__main__":    main()

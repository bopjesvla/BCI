% --- Creates and returns a handle to the GUI figure. 
function h1 = sigProcOptsFig(policy)
% policy - create a new figure or use a singleton. 'new' or 'reuse'.

persistent hsingleton;
if ( nargin<1 ) policy='reuse'; end;
if strcmpi(policy, 'reuse') & ishandle(hsingleton)
    h1 = hsingleton;
    return;
end

h1 = figure(...
'Color',[0.701960784313725 0.701960784313725 0.701960784313725],...
'Colormap',[0 0 0.5625;0 0 0.625;0 0 0.6875;0 0 0.75;0 0 0.8125;0 0 0.875;0 0 0.9375;0 0 1;0 0.0625 1;0 0.125 1;0 0.1875 1;0 0.25 1;0 0.3125 1;0 0.375 1;0 0.4375 1;0 0.5 1;0 0.5625 1;0 0.625 1;0 0.6875 1;0 0.75 1;0 0.8125 1;0 0.875 1;0 0.9375 1;0 1 1;0.0625 1 1;0.125 1 0.9375;0.1875 1 0.875;0.25 1 0.8125;0.3125 1 0.75;0.375 1 0.6875;0.4375 1 0.625;0.5 1 0.5625;0.5625 1 0.5;0.625 1 0.4375;0.6875 1 0.375;0.75 1 0.3125;0.8125 1 0.25;0.875 1 0.1875;0.9375 1 0.125;1 1 0.0625;1 1 0;1 0.9375 0;1 0.875 0;1 0.8125 0;1 0.75 0;1 0.6875 0;1 0.625 0;1 0.5625 0;1 0.5 0;1 0.4375 0;1 0.375 0;1 0.3125 0;1 0.25 0;1 0.1875 0;1 0.125 0;1 0.0625 0;1 0 0;0.9375 0 0;0.875 0 0;0.8125 0 0;0.75 0 0;0.6875 0 0;0.625 0 0;0.5625 0 0],...
'DockControls','off',...
'IntegerHandle','off',...
'InvertHardcopy',get(0,'defaultfigureInvertHardcopy'),...
'MenuBar','none',...
'Name','Untitled',...
'NumberTitle','off',...
'PaperPosition',get(0,'defaultfigurePaperPosition'),...
'Position',[544 296 218 329],...
'Renderer',get(0,'defaultfigureRenderer'),...
'RendererMode','manual',...
'HandleVisibility','callback',...
'Tag','figure1',...
'UserData',[],...
'Visible','on','Name','Sig Proc Options');

%--------------------------------------------------------------------------------------------------
% pre-process

try
h12 = uibuttongroup(...
'Parent',h1,...
'Title','Pre-processing',...
'Position',[0.0871559633027523 0.750759878419453 0.848623853211009 0.21580547112462],...
'Tag','preproc',...
'Behavior',struct(),...
'SelectedObject',[],...
'SelectionChangeFcn',@(o,v) setappdata(gcbf(),get(o,'tag'),get(get(o,'SelectedObject'),'String')),...
...%'createfcn',@(o,v) setappdata(gcbf(),get(o,'tag'),get(get(o,'SelectedObject'),'String')),...    
'OldSelectedObject',[]);
catch
  h12=[];
end

h13 = uicontrol(...
'Parent',h12,...
'Units','normalized',...
'FontSize',8,...
'Position',[0.101604278074866 0.166666666666667 0.705882352941176 0.203703703703704],...
'String','Detrend',...
'Style','radiobutton',...
'Value',1,...
'Tag','detrendbut');

h14 = uicontrol(...
'Parent',h12,...
'Units','normalized',...
'FontSize',8,...
'Position',[0.101604278074866 0.444444444444444 0.705882352941176 0.203703703703704],...
'String','Center',...
'Style','radiobutton',...
'Tag','radiobutton24');

h15 = uicontrol(...
'Parent',h12,...
'Units','normalized',...
'FontSize',8,...
'Position',[0.101604278074866 0.722222222222222 0.705882352941176 0.203703703703704],...
'String','None',...
'Style','radiobutton',...
'Tag','radiobutton25');

%--------------------------------------------------------------------------------------------------
% badchrm

h16 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'Position',[0.0871559633027523 0.629179331306991 0.484403669724771 0.0638297872340425],...
'String','Bad Chan Rm',...
'Style','checkbox',...
'Value',1,...
'Tag','badchrm',...
'callback',@(o,v) setappdata(gcbf(),get(o,'tag'),get(o,'value')),...
'createfcn',@(o,v) setappdata(gcbf(),get(o,'tag'),get(o,'value')));

h17 = uicontrol(...
'Parent',h1,...
'Units','normalized',...
'BackgroundColor',[1 1 1],...
'FontSize',8,...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'Position',[0.583672316384181 0.629179331306991 0.350282485875706 0.0638297872340425],...
'String','3',...
'Style','edit',...
'Tag','badchthresh',...
'UserData',[],...
    'callback',@(o,v) setappdata(gcbf(),get(o,'tag'),num2str(get(o,'value'))),...
    'createfcn',@(o,v) setappdata(gcbf(),get(o,'tag'),num2str(get(o,'value'))));

%--------------------------------------------------------------------------------------------------
% spat filt

try
h2 = uibuttongroup(...
'Parent',h1,...
'Title','Spatial Filter',...
'Position',[0.0688073394495413 0.340425531914894 0.848623853211009 0.258358662613982],...
'Tag','spatfilt',...
'Behavior',struct(),...
'SelectedObject',[],...
'SelectionChangeFcn',@(o,v) setappdata(gcbf(),get(o,'tag'),get(get(o,'SelectedObject'),'String')),...
...%'createfcn',@(o,v) setappdata(gcbf(),get(o,'tag'),get(get(o,'SelectedObject'),'String')),...    
'OldSelectedObject',[]);
catch
  h2=[];
end

h3 = uicontrol(...
'Parent',h2,...
'Units','normalized',...
'FontSize',8,...
'Position',[0.0451977401129944 0.75 0.898305084745763 0.202380952380952],...
'String','None',...
'Style','radiobutton',...
'Tag','radiobutton20');

h4 = uicontrol(...
'Parent',h2,...
'Units','normalized',...
'FontSize',8,...
'Position',[0.0451977401129944 0.547619047619048 0.898305084745763 0.202380952380952],...
'String','CAR',...
'Style','radiobutton',...
'Value',1,...
'Tag','radiobutton21');


h5 = uicontrol(...
'Parent',h2,...
'Units','normalized',...
'FontSize',8,...
'Position',[0.0451977401129944 0.345238095238095 0.898305084745763 0.202380952380952],...
'String','SLAP',...
'Style','radiobutton',...
'Tag','radiobutton22');

h6 = uicontrol(...
'Parent',h2,...
'Units','normalized',...
'FontSize',8,...
'Position',[0.0508474576271186 0.154761904761905 0.898305084745763 0.202380952380952],...
'String','Whiten',...
'Style','radiobutton',...
'Tag','radiobutton23');

% this doesn't work in createfcn as selected object isn't available
%setappdata(h1,get(h2,'tag'),get(get(h2,'SelectedObject'),'String'));

%--------------------------------------------------------------------------------------------------
% spect filt
h7 = uipanel(...
'Parent',h1,...
'Title','Spectral Filter',...
'Position',[0.0688073394495413 0.0516717325227964 0.848623853211009 0.243161094224924],...
'Tag','spectfilt',...
'UserData',[]);

h8 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontSize',8,...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'Position',[0.104972375690608 0.619047619047619 0.403314917127072 0.238095238095238],...
'String','Low Cut-off',...
'Style','text',...
'Tag','text1',...
'UserData',[]);

h9 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'FontSize',8,...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'Position',[0.096045197740113 0.259259259259259 0.412429378531073 0.240740740740741],...
'String','High cut-off',...
'Style','text',...
'Tag','text2',...
'UserData',[]);

h10 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'BackgroundColor',[1 1 1],...
'FontSize',8,...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'Position',[0.559322033898305 0.574074074074073 0.344632768361582 0.351851851851852],...
'String','0',...
'Style','edit',...
'Tag','lowcutoff',...
'UserData',[],...
    'callback',@(o,v) setappdata(gcbf(),get(o,'tag'),num2str(get(o,'value'))),...
    'createfcn',@(o,v) setappdata(gcbf(),get(o,'tag'),num2str(get(o,'value'))) );

h11 = uicontrol(...
'Parent',h7,...
'Units','normalized',...
'BackgroundColor',[1 1 1],...
'FontSize',8,...
'HorizontalAlignment','right',...
'ListboxTop',0,...
'Position',[0.553672316384181 0.111111111111111 0.350282485875706 0.351851851851852],...
'String','0',...
'Style','edit',...
'Tag','highcutoff',...
'UserData',[],...
    'callback',@(o,v) setappdata(gcbf(),get(o,'tag'),num2str(get(o,'value'))),...
    'createfcn',@(o,v) setappdata(gcbf(),get(o,'tag'),num2str(get(o,'value'))));

guidata(h1,guihandles(h1));
hsingleton = h1;
